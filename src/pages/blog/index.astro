---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import NewsletterCTA from '../../components/NewsletterCTA.astro';
import BlogHero from '../../components/BlogHero.astro';
import CategoryFilter from '../../components/CategoryFilter.astro';
import PostsGrid from '../../components/PostsGrid.astro';

// Get all blog posts from all collections sorted by date
const dogsPosts = await getCollection('dogs');
const catsPosts = await getCollection('cats');
const productsPosts = await getCollection('products-reviews');

const allPosts = [...dogsPosts, ...catsPosts, ...productsPosts];
const sortedPosts = allPosts.sort((a, b) => 
  new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime()
);
---

<BaseLayout
  title="Blog - Pet Care Articles & Guides | Pet Care Blog"
  description="Browse our collection of expert pet care articles, guides, and product reviews. Find tips on dog training, cat care, nutrition, and more."
>
  <BlogHero />
  <CategoryFilter />
  <PostsGrid posts={sortedPosts} featuredIndex={0} />
  <section class="section-padding" style="background-color: var(--color-alabaster);">
    <div class="container-blog max-w-4xl">
      <NewsletterCTA />
    </div>
  </section>
</BaseLayout>
